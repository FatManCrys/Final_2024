---
title: "Covid91 vaccine study Final2024"
author: "David ACevedo"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
OldData <-read.csv(file="finalSumr2024.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- OldData %>% mutate(infected = recode(infected, covid19 = "covid", none = "OK" )) %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
FinalData$treatment <- relevel(FinalData$treatment,ref="placebo")
#FinalData$infected <- relevel(FinalData$infected,ref="OK")
Male = filter(FinalData, sex =="M")
Female = filter(FinalData, sex =="F")
Gay = filter(FinalData, LGBTQ =="gay")
DrugUser = filter(FinalData, DrugUser =="yes")
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

## Males

### Summary of Males

```{r}
male_summary <- Male %>%
  group_by(treatment, infected) %>%
  summarise(count = n(), .groups = "drop") %>%
  pivot_wider(names_from = infected, values_from = count, values_fill = 0)
male_summary <- male_summary %>%
  mutate(total = rowSums(select(., -treatment)))
male_column_totals <- male_summary %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(treatment = "Total")
male_summary <- bind_rows(male_summary, male_column_totals)
male_summary
```

the summary of males shows that the total males are 18392, 355 of the males have covid whilst 18037 are fine so lets make a visual representation of it with a barplot.

### Visual Results

```{r}
# Bar plot

# Summarize the data for Males by infection status and treatment
male_summary_data <- Male %>%
  group_by(infected, treatment) %>%
  summarize(count = n(), .groups = "drop") %>%
  mutate(prcnt = count / sum(count))

# Bar plot for count of infected vs treatment
male_plot_count <- ggplot(male_summary_data, aes(x = infected, y = count, fill = treatment))
male_plot_count + 
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Number of Males Infected by Treatment",
       x = "Infection Status", y = "Count of Infected Males") +
  scale_fill_manual(values = c("placebo" = "gray", "vaccine" = "green")) +
  theme_minimal()

# Bar plot for percentage of infected vs treatment
male_plot_percent <- ggplot(male_summary_data, aes(x = infected, y = prcnt * 100, fill = treatment))
male_plot_percent + 
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Percentage of Males Infected by Treatment",
       x = "Infection Status", y = "Percentage of Infected Males") +
  scale_fill_manual(values = c("placebo" = "gray", "vaccine" = "green")) +
  theme_minimal()
```

these barplots show us the number of males infected with covid, obvoiusly the males with the vaccine have less covid than the placebo but the results are very much close to eachother but to truly see the results we need a diffrent graph.

## Females


## LGBTQ



## Druggies


# Overall Results and Conclusions